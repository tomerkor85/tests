# RadixInsight - פרויקט משודרג

פרויקט זה הוא גרסה משודרגת של RadixInsight, לאחר רפקטורינג וארגון מחדש של הקוד לפי עקרונות מודולריים.

## מבנה הפרויקט החדש

הפרויקט אורגן מחדש לפי הדומיינים הבאים:

- **core/** - לוגיקה עסקית וחיבורי מסדי נתונים
  - **db/** - מודולי חיבור למסדי נתונים (PostgreSQL, ClickHouse)
  - **services/** - שירותים עסקיים
  - **models/** - מודלים ומבני נתונים

- **api/** - נקודות קצה ומידלוור
  - **routes/** - הגדרות נתיבי API
  - **middlewares/** - מידלוור לאימות ועיבוד בקשות
  - **controllers/** - בקרים לטיפול בלוגיקת הבקשות

- **ui/** - ממשק משתמש
  - **views/** - דפי HTML
  - **public/** - קבצים סטטיים (CSS, JS, תמונות)

- **utils/** - פונקציות עזר
  - **validators.js** - פונקציות לאימות נתונים
  - **link-validator/** - כלים לבדיקת קישורים

- **config/** - הגדרות וטעינת משתני סביבה
  - **index.js** - קובץ קונפיגורציה מרכזי
  - **.env.example** - דוגמה למשתני סביבה

- **scripts/** - סקריפטים להרצה אוטומטית
  - **start.sh** - סקריפט הפעלה
  - **deploy.sh** - סקריפט פריסה

- **docs/** - תיעוד טכני
  - **index.md** - תיעוד ראשי
  - **data-flow.md** - תיעוד זרימת נתונים
  - **security.md** - תיעוד אבטחה ופרטיות

- **database/schema/** - סכמות מסדי נתונים
  - **clickhouse_schema.sql** - סכמת ClickHouse

## שינויים עיקריים

1. **ארגון מחדש של מבנה התיקיות** - הקוד אורגן לפי דומיינים פונקציונליים
2. **האחדת משתני סביבה** - שינוי משתני ClickHouse מ-`CH_*` ל-`CLICKHOUSE_*`
3. **יצירת קובץ קונפיגורציה מרכזי** - כל ההגדרות מרוכזות ב-`config/index.js`
4. **הפרדת שכבות** - הפרדה ברורה בין לוגיקה עסקית, API, ו-UI
5. **ארגון מחדש של תיעוד** - העברת התיעוד לתיקיית `docs/` וחלוקה לנושאים

## הפעלת הפרויקט

### סביבה מקומית

```bash
# התקנת תלויות
npm install

# הפעלה בסביבת פיתוח
npm run dev
```

### סביבת Docker

```bash
# בניית והפעלת קונטיינרים
docker-compose up --build

# הפעלת פקודות בתוך קונטיינר
docker-compose exec app npm run dev
```

### סביבת ייצור

```bash
# התקנת תלויות ייצור בלבד
npm ci --production

# הפעלה בסביבת ייצור
npm start
```

## תיקון חיבור ClickHouse

בעיית החיבור ל-ClickHouse נפתרה על ידי:
1. שינוי שמות המשתנים מ-`CH_*` ל-`CLICKHOUSE_*`
2. עדכון קובץ `.env` והתאמתו לשמות החדשים
3. עדכון קובץ `clickhouse-db.js` לשימוש בקונפיגורציה החדשה

## הכנה למיקרוסרביסים

הארכיטקטורה החדשה מכינה את הקרקע למיקרוסרביסים בעתיד:
1. הפרדה ברורה בין שכבות ודומיינים
2. מודולריות גבוהה המאפשרת הפרדה קלה לשירותים נפרדים
3. קונפיגורציה מרכזית שניתנת להרחבה לכל שירות
